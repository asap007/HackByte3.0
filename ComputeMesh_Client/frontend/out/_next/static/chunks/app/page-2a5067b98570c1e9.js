(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3934:function(e,t,a){Promise.resolve().then(a.bind(a,341))},341:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ec}});var s=a(7437),r=a(2265),n=a(6869),l=a(7053),o=a(535),c=a(1994),i=a(3335);function d(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,i.m6)((0,c.W)(t))}let u=(0,o.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),m=r.forwardRef((e,t)=>{let{className:a,variant:r,size:n,asChild:o=!1,...c}=e,i=o?l.g7:"button";return(0,s.jsx)(i,{className:d(u({variant:r,size:n,className:a})),ref:t,...c})});m.displayName="Button";var x=a(4613),h=a(2489);let g=x.fC;x.xz;let p=x.h_;x.x8;let f=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(x.aV,{ref:t,className:d("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});f.displayName=x.aV.displayName;let v=r.forwardRef((e,t)=>{let{className:a,children:r,...n}=e;return(0,s.jsxs)(p,{children:[(0,s.jsx)(f,{}),(0,s.jsxs)(x.VY,{ref:t,className:d("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...n,children:[r,(0,s.jsxs)(x.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(h.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});v.displayName=x.VY.displayName;let b=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:d("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};b.displayName="DialogHeader";let w=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(x.Dx,{ref:t,className:d("text-lg font-semibold leading-none tracking-tight",a),...r})});w.displayName=x.Dx.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(x.dk,{ref:t,className:d("text-sm text-muted-foreground",a),...r})}).displayName=x.dk.displayName;var j=a(6076);function y(e){let{open:t,onClose:a}=e;return(0,s.jsx)(g,{open:t,onOpenChange:a,children:(0,s.jsxs)(v,{className:"bg-[#1a1a2e] border border-gray-800 text-white max-w-md",children:[(0,s.jsx)(b,{children:(0,s.jsxs)(w,{className:"text-center text-xl font-semibold flex items-center justify-center gap-2",children:[(0,s.jsx)(j.Z,{className:"h-6 w-6 text-purple-500 animate-bounce"}),"Coming Soon!"]})}),(0,s.jsx)("div",{className:"p-6 text-center",children:(0,s.jsx)("p",{className:"text-lg text-gray-300",children:"Hang Tight. We are currently working on the feature! \uD83D\uDE80"})})]})})}function N(e){let{userData:t,onConnectWallet:a}=e,[n,l]=r.useState(!1);return(0,s.jsxs)("header",{className:"flex items-center justify-between px-4 py-2 bg-[#12121f] border-b border-gray-800",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("img",{src:"https://zgzfpxamyedvgkvh.public.blob.vercel-storage.com/ComputeMesh%20Logo-65v9DaySZ5gBRpTeCeLzqKF0nWaG8a.ico",alt:"DLLM Logo",width:32,height:32,className:"w-8 h-8"}),(0,s.jsx)("span",{className:"text-white text-xl font-semibold",children:"ComputeMesh"}),(0,s.jsx)("span",{className:"bg-[#1f1f2f] text-xs px-2 py-1 rounded",children:"AI"}),(0,s.jsx)("span",{className:"text-gray-400 text-sm ml-2",children:"0.0.1"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(null==t?void 0:t.wallet_address)?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{className:"bg-green-900/20 border border-green-700 rounded-lg px-3 py-1 flex items-center",children:[(0,s.jsx)("svg",{className:"w-4 h-4 text-green-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,s.jsxs)("span",{className:"text-green-200 text-sm",children:[t.wallet_address.substring(0,6),"...",t.wallet_address.substring(58)]})]}),(0,s.jsx)(m,{variant:"outline",className:"bg-gray-700 hover:bg-gray-600 text-white",onClick:a,children:"Change"})]}):(0,s.jsx)(m,{className:"bg-purple-500 hover:bg-purple-600",onClick:a,children:"Connect Wallet"}),(0,s.jsx)(y,{open:n,onClose:()=>l(!1)})]})]})}var k=a(7692),S=a(3145);function C(e){var t;let{onLogout:a,userData:r}=e,n=(null==r?void 0:r.name)||(null==r?void 0:null===(t=r.email)||void 0===t?void 0:t.split("@")[0])||"User",l=(null==r?void 0:r.profile_picture)||"https://ui-avatars.com/api/?name=".concat(encodeURIComponent(n),"&background=random&color=fff");return(0,s.jsx)("div",{className:"flex justify-end items-center p-4 bg-[#1a1a2e] rounded-lg mb-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(S.default,{src:l,alt:n,width:32,height:32,className:"rounded-full"}),(0,s.jsx)("span",{className:"text-white",children:n}),(0,s.jsx)(m,{variant:"ghost",size:"icon",onClick:a,className:"ml-2 text-gray-400 hover:text-red-500 hover:bg-red-500/10 transition-colors duration-200",children:(0,s.jsx)(k.Z,{className:"h-4 w-4"})})]})})}var I=a(6399),_=a(6362);let E=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:d("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});E.displayName="Card";let T=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:d("flex flex-col space-y-1.5 p-6",a),...r})});T.displayName="CardHeader";let A=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:d("text-2xl font-semibold leading-none tracking-tight",a),...r})});A.displayName="CardTitle",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:d("text-sm text-muted-foreground",a),...r})}).displayName="CardDescription";let R=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:d("p-6 pt-0",a),...r})});R.displayName="CardContent";let P=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:d("flex items-center p-6 pt-0",a),...r})});function F(){let[e,t]=(0,r.useState)([]),[a,n]=(0,r.useState)(!0),[l,o]=(0,r.useState)(null),c=e=>{var t,a;(null===(a=window.electron)||void 0===a?void 0:null===(t=a.shell)||void 0===t?void 0:t.openExternal)?window.electron.shell.openExternal(e):window.open(e,"_blank","noopener,noreferrer")},i=async()=>{try{o(null);let e=await fetch("http://localhost:8000/leaderboard/agents");if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let a=[...await e.json()].sort((e,t)=>t.score-e.score);t(a)}catch(e){console.error("Error fetching agent leaderboard:",e),o("Failed to load agents")}finally{n(!1)}};(0,r.useEffect)(()=>{i();let e=setInterval(i,3e4);return()=>clearInterval(e)},[]);let d=e=>{window.open(e,"_blank","noopener,noreferrer")};return(0,s.jsxs)(E,{className:"bg-[#1a1a2e] border-0",children:[(0,s.jsx)(T,{children:(0,s.jsxs)(A,{className:"text-white flex items-center justify-center",children:[(0,s.jsx)(I.Z,{className:"w-5 h-5 text-orange-500 mr-2"}),(0,s.jsx)("span",{children:"Trending Agents"}),(0,s.jsx)(I.Z,{className:"w-5 h-5 text-orange-500 ml-2"})]})}),(0,s.jsx)(R,{children:a?(0,s.jsx)("p",{className:"text-gray-400 text-center",children:"Loading..."}):l?(0,s.jsx)("p",{className:"text-red-400 text-center",children:l}):0===e.length?(0,s.jsx)("p",{className:"text-gray-400 text-center",children:"No agents found"}):(0,s.jsx)("div",{className:"space-y-4",children:e.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(S.default,{src:"https://ui-avatars.com/api/?name=".concat(encodeURIComponent(e.agent_name),"&background=random&color=fff"),alt:e.agent_name,width:24,height:24,className:"rounded-full"}),(0,s.jsx)("span",{className:"text-white",children:e.agent_name})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("span",{className:"text-gray-400",children:e.score}),(0,s.jsxs)(m,{variant:"outline",size:"sm",className:"bg-[#12121f] border-0 text-gray-400 hover:text-white hover:bg-[#1f1f2f] px-3",onClick:()=>d(e.agent_link),children:["Go",(0,s.jsx)(_.Z,{className:"ml-2 h-3 w-3"})]})]})]},"".concat(e.agent_name,"-").concat(t)))})}),(0,s.jsx)(P,{children:(0,s.jsx)(m,{className:"w-full bg-purple-500 hover:bg-purple-600 text-white",onClick:e=>{e.preventDefault(),c("http://localhost:8000/leaderboard/agents/all")},disabled:a||!!l,children:"See More Agents"})})]})}P.displayName="CardFooter";var L=a(2926),D=a(5395);let M="http://127.0.0.1:".concat(39281),Z="llama-cpp",z="tinyllama:1b",W="http://127.0.0.1:8000";function O(){let[e,t]=(0,r.useState)(()=>parseFloat(sessionStorage.getItem("miningTime")||"60")),[a,n]=(0,r.useState)(()=>parseFloat(sessionStorage.getItem("miningPending")||"0")),[l,o]=(0,r.useState)(()=>parseFloat(localStorage.getItem("savedScore")||"40")),[c,i]=(0,r.useState)(!1),[d,u]=(0,r.useState)("disconnected"),[m,x]=(0,r.useState)(!1),[h,g]=(0,r.useState)(null),[p,f]=(0,r.useState)(!1),[v,b]=(0,r.useState)(z),w=(0,r.useRef)(null),j=(0,r.useRef)(null),y=(0,r.useRef)(null),N=(0,r.useRef)(0),k=(0,r.useRef)(null),S=(0,r.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";console.log("[".concat(new Date().toLocaleTimeString(),"] [MiningCard-").concat(t.toUpperCase(),"] ").concat(e))},[]),C=(0,r.useCallback)(e=>{var t,a;S("Opening external URL: ".concat(e),"info"),(null===(a=window.electron)||void 0===a?void 0:null===(t=a.shell)||void 0===t?void 0:t.openExternal)?window.electron.shell.openExternal(e).catch(e=>S("Electron failed to open URL: ".concat(e),"error")):window.open(e,"_blank","noopener,noreferrer")},[S]),I=(0,r.useCallback)(()=>{S("Resetting mining timer and pending points."),t(60),n(0),i(!0),sessionStorage.setItem("miningTime","60"),sessionStorage.setItem("miningPending","0")},[S]),_=(0,r.useCallback)(()=>{y.current&&(clearInterval(y.current),y.current=null,i(!1),S("Mining progress timer stopped."))},[S]),T=(0,r.useCallback)(async()=>{S("Attempting to save ".concat(10," points via API."));try{let e=localStorage.getItem("authToken");if(!e){S("No auth token found for score update","warn");return}let t=await fetch("".concat(W,"/user/points"),{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({points:10})});if(!t.ok){let e=await t.json().catch(()=>({detail:"HTTP error! status: ".concat(t.status)}));throw Error(e.detail||"HTTP error! status: ".concat(t.status))}let a=await t.json();o(e=>{let t="number"==typeof a.total_points?a.total_points:e+10;return localStorage.setItem("savedScore",t.toString()),S("Successfully updated points via API. New saved total: ".concat(t.toFixed(2))),t}),I()}catch(e){console.error("Error updating points:",e),S("Failed to update points: ".concat(e.message),"error"),_()}},[S,I,_]),A=(0,r.useCallback)(()=>{if(!y.current){if("connected"!==d){S("Cannot start mining progress: WebSocket not connected.","warn");return}i(!0),S("Starting mining progress timer."),y.current=setInterval(()=>{let e=!1;t(t=>{let a=Math.max(0,t-1);return sessionStorage.setItem("miningTime",a.toString()),a<=0&&(e=!0),a}),n(e=>{let t=e+.1;return sessionStorage.setItem("miningPending",t.toString()),parseFloat(t.toFixed(1))}),e&&(S("Mining cycle complete."),_(),T())},1e3)}},[S,_,T,d]),P=(0,r.useCallback)(e=>{var t;if((null===(t=w.current)||void 0===t?void 0:t.readyState)===WebSocket.OPEN)try{w.current.send(JSON.stringify(e))}catch(e){S("Failed to send WebSocket message: ".concat(e.message),"error")}else S("Cannot send WebSocket message: connection not open","warn")},[S]),F=(0,r.useCallback)((e,t)=>{P({command_id:e,result:t})},[P]),O=(0,r.useCallback)((e,t)=>{S("Sending error response for ".concat(e,": ").concat(t),"error"),P({command_id:e,result:{error:t}})},[S,P]),B=(0,r.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3e4,r="".concat(M).concat(e);S("Calling Cortex API: ".concat(t," ").concat(r),"debug");let n=new AbortController,l=setTimeout(()=>n.abort(),s);try{let e={method:t,headers:{"Content-Type":"application/json",Accept:"application/json"},signal:n.signal};a&&"GET"!==t&&"HEAD"!==t&&(e.body=JSON.stringify(a));let s=await fetch(r,e);if(clearTimeout(l),!s.ok){var o;let e;try{e=await s.json()}catch(t){e={detail:s.statusText}}let a=(null==e?void 0:null===(o=e.error)||void 0===o?void 0:o.message)||(null==e?void 0:e.detail)||"HTTP error ".concat(s.status);throw S("Cortex API Error (".concat(t," ").concat(r,"): ").concat(a),"error"),Error(a)}let c=s.headers.get("content-type");if(null==c?void 0:c.includes("application/json"))return await s.json();if(204===s.status||"0"===s.headers.get("content-length"))return null;{let e=await s.text();return S("Cortex API Success (".concat(t," ").concat(r,"): Received non-JSON response: ").concat(e.substring(0,100),"..."),"warn"),{raw_response:e}}}catch(e){if(clearTimeout(l),"AbortError"===e.name)throw S("Cortex API Timeout: ".concat(t," ").concat(r),"error"),Error("Request timed out after ".concat(s/1e3,"s"));throw S("Cortex API Fetch Error (".concat(t," ").concat(r,"): ").concat(e.message),"error"),e}},[S]),U=(0,r.useCallback)(async()=>{if(m)return!0;S("Loading engine '".concat(Z,"'..."));try{return await B("/v1/engines/".concat(Z,"/load"),"POST"),S("Engine '".concat(Z,"' loaded successfully.")),x(!0),!0}catch(e){return S("Failed to load engine '".concat(Z,"': ").concat(e.message),"error"),x(!1),!1}},[m,S,B]);(0,r.useCallback)(async()=>{S("Unloading engine '".concat(Z,"'..."));try{await B("/v1/engines/".concat(Z,"/load"),"DELETE"),S("Engine '".concat(Z,"' unloaded successfully.")),x(!1)}catch(e){S("Failed to unload engine '".concat(Z,"': ").concat(e.message),"error")}},[S,B]);let q=(0,r.useCallback)(async()=>{try{var e;let t=await B("/v1/models","GET"),a=(null==t?void 0:t.data)||[],s=(null===(e=a.find(e=>e.id))||void 0===e?void 0:e.id)||null;return S("Current loaded model: ".concat(s||"None")),g(s),s}catch(e){return S("Failed to get current model: ".concat(e.message),"error"),g(null),null}},[B,S]),G=(0,r.useCallback)(async()=>{let e=await q();if(!e)return!0;S("Stopping current model '".concat(e,"'..."));try{return await B("/v1/models/stop","POST",{model:e}),S("Model '".concat(e,"' stopped successfully.")),g(null),!0}catch(t){return S("Failed to stop model '".concat(e,"': ").concat(t.message),"error"),!1}},[B,q,S]),H=(0,r.useCallback)(async e=>{S("Starting model '".concat(e,"'..."));try{return await B("/v1/models/start","POST",{model:e},12e4),S("Model '".concat(e,"' started successfully.")),g(e),!0}catch(t){return S("Failed to start model '".concat(e,"': ").concat(t.message),"error"),g(null),!1}},[B,S]),V=(0,r.useCallback)(async e=>{if(p)return S("Model state management already in progress, skipping.","warn"),!1;f(!0),S("Loading model '".concat(e,"'..."));try{if(!await U())throw Error("Engine '".concat(Z,"' could not be loaded"));if(await G(),!await H(e))throw Error("Failed to start model '".concat(e,"'"));return!0}catch(e){return S("Model load failed: ".concat(e.message),"error"),!1}finally{f(!1)}},[p,U,S,H,G]),Y=(0,r.useCallback)(async e=>{let{method:t,url:a,data:s,command_id:r}=e;if(S("Received command ".concat(r,": ").concat(t," ").concat(a),"info"),!t||!a||!r){S("Invalid command received: Missing method, url, or command_id","error");return}try{let e;let n=null;if(("/v1/chat/completions"===a||a.startsWith("/v1/chat/"))&&(n=(null==s?void 0:s.model)||z,S("Command ".concat(r," requires model: ").concat(n),"debug")),n&&!await V(n))throw Error("Failed to load required model '".concat(n,"'"));e=await B(a,t,s),F(r,e)}catch(e){S("Command ".concat(r," (").concat(t," ").concat(a,") failed: ").concat(e.message),"error"),O(r,e.message||"Unknown error occurred during command execution")}},[B,V,S,O,F]),J=(0,r.useCallback)(()=>{w.current&&(w.current.onclose=null,w.current.close(1e3,"Reinitializing"),w.current=null),j.current&&(clearTimeout(j.current),j.current=null);let e=localStorage.getItem("authToken");if(!e){u("disconnected"),_(),S("Auth token missing, WebSocket connection cancelled.","warn");return}let t=W.startsWith("https:")?"wss:":"ws:",a=W.replace(/^http(s?):\/\//,""),s="".concat(t,"//").concat(a,"/ws?token=").concat(encodeURIComponent(e),"&http_base_url=").concat(encodeURIComponent(M));S("Attempting WebSocket connection to backend: ".concat(s.split("?")[0],"?token=REDACTED&http_base_url=").concat(encodeURIComponent(M))),u("connecting");try{let e=new WebSocket(s);w.current=e,e.onopen=()=>{u("connected"),N.current=0,S("WebSocket connection established with backend."),A(),V(z).catch(e=>S("Failed to load default model: ".concat(e.message),"error"))},e.onmessage=async e=>{try{let t=JSON.parse(e.data);if("ping"===t.type){P({type:"pong"});return}t.command_id&&t.method&&t.url?await Y(t):S("Received non-command message or invalid command structure","warn")}catch(e){S("Error processing WebSocket message: ".concat(e.message),"error")}},e.onclose=e=>{if(u("disconnected"),_(),w.current=null,S("WebSocket connection closed. Code: ".concat(e.code,", Reason: ").concat(e.reason||"None",", Clean: ").concat(e.wasClean)),1e3!==e.code&&localStorage.getItem("authToken")){if(N.current++,N.current<=5){let e=3e3*Math.pow(2,N.current-1);S("Attempting reconnect ".concat(N.current,"/").concat(5," in ").concat(e/1e3,"s..."),"warn"),j.current=setTimeout(J,e)}else S("Max WebSocket reconnection attempts reached.","error")}else S("WebSocket closed cleanly or token removed. No automatic reconnect planned."),N.current=0},e.onerror=e=>{u("error"),S("WebSocket error occurred. Check console for details. Connection will close.","error")}}catch(e){if(console.error("WebSocket initialization failed:",e),u("error"),_(),S("Failed to initialize WebSocket: ".concat(e.message),"error"),localStorage.getItem("authToken")){if(N.current++,N.current<=5){let e=3e3*Math.pow(2,N.current-1);S("Retrying connection attempt ".concat(N.current,"/").concat(5," in ").concat(e/1e3,"s..."),"warn"),j.current=setTimeout(J,e)}else S("Max connection attempts reached after init failure.","error")}}},[S,A,_,Y,P,V,d]);(0,r.useEffect)(()=>{t(parseFloat(sessionStorage.getItem("miningTime")||60)),n(parseFloat(sessionStorage.getItem("miningPending")||0)),o(parseFloat(localStorage.getItem("savedScore")||40)),J();let e=()=>{S("Browser detected online status.","info"),"connected"!==d&&!j.current&&N.current<5&&(S("Attempting WebSocket reconnect after coming online."),J())},a=()=>{S("Browser detected offline status.","warn"),u("offline"),_(),w.current&&w.current.close(1e3,"Browser offline"),j.current&&(clearTimeout(j.current),j.current=null,S("Cleared pending WebSocket reconnect attempts due to offline status.")),N.current=0};return window.addEventListener("online",e),window.addEventListener("offline",a),()=>{S("MiningCard unmounting. Cleaning up..."),_(),window.removeEventListener("online",e),window.removeEventListener("offline",a),j.current&&clearTimeout(j.current),w.current&&(w.current.onclose=null,w.current.close(1e3,"Component unmounting"),w.current=null),k.current&&clearTimeout(k.current),S("MiningCard cleanup complete.")}},[]);let $=Math.min(100,(60-e)/60*100),K=(()=>{switch(d){case"connected":return{color:"text-green-500",text:"Connected",icon:(0,s.jsx)(L.Z,{className:"w-4 h-4 mr-1"})};case"connecting":return{color:"text-yellow-500",text:"Connecting...",icon:(0,s.jsx)(D.Z,{className:"w-4 h-4 mr-1"})};case"offline":return{color:"text-gray-500",text:"Offline",icon:(0,s.jsx)(D.Z,{className:"w-4 h-4 mr-1"})};case"error":return{color:"text-red-500",text:"Error",icon:(0,s.jsx)(D.Z,{className:"w-4 h-4 mr-1"})};default:return{color:"text-orange-500",text:N.current>0?"Reconnecting (".concat(N.current,")"):"Disconnected",icon:(0,s.jsx)(D.Z,{className:"w-4 h-4 mr-1"})}}})();return(0,s.jsx)(E,{className:"bg-[#1a1a2e] border-0 h-full flex flex-col text-white",children:(0,s.jsxs)(R,{className:"p-6 flex flex-col flex-grow",children:[(0,s.jsx)("div",{className:"flex justify-end mb-2",children:(0,s.jsxs)("div",{className:"flex items-center ".concat(K.color),children:[K.icon,(0,s.jsx)("span",{className:"text-xs",children:K.text})]})}),(0,s.jsx)("button",{className:"w-full bg-[#12121f] text-emerald-400 p-3 rounded-lg mb-6 transition-all duration-200 ease-in-out shrink-0 hover:bg-emerald-400 hover:text-[#12121f] active:scale-95 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-50",onClick:()=>C("".concat(W,"/survey")),children:"Complete the Survey (+1200 Tokens)"}),(0,s.jsxs)("div",{className:"text-center mb-6 shrink-0",children:[(0,s.jsx)("div",{className:"text-gray-400 mb-2 uppercase text-sm",children:"Pending"}),(0,s.jsx)("div",{className:"text-4xl text-white mb-4",children:a.toFixed(1)})]}),(0,s.jsxs)("div",{className:"mb-6 shrink-0",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center mb-2",children:[(0,s.jsx)("span",{className:"text-gray-400 text-sm",children:"Saved"}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"text-2xl text-white",children:l.toFixed(2)}),(0,s.jsx)("span",{className:"text-gray-400 text-sm",children:"Tokens"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"flex-1 h-2 bg-[#12121f] rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-green-500 rounded-full transition-width duration-1000 ease-linear",style:{width:"".concat($,"%")},"aria-valuenow":$,"aria-valuemin":0,"aria-valuemax":100,role:"progressbar"})}),(0,s.jsx)("span",{className:"text-gray-400 text-sm whitespace-nowrap w-20 text-right",children:c&&e>0?"".concat(Math.floor(e/60),":").concat((e%60).toString().padStart(2,"0")," left"):e<=0&&c?"Saving...":"connected"===d&&!c&&e>0?"Starting...":"Paused"})]})]}),(0,s.jsx)("div",{className:"text-gray-400 text-sm mt-auto shrink-0 text-center",children:"Keep this provider running to earn tokens."})]})})}var B=a(401),U=a(8617),q=a(4822),G=a(8919),H=a(8867);function V(e){let{open:t,onClose:a}=e;return(0,s.jsx)(g,{open:t,onOpenChange:a,children:(0,s.jsxs)(v,{className:"bg-[#1a1a2e] border border-gray-800 text-white max-w-md",children:[(0,s.jsx)(b,{children:(0,s.jsxs)(w,{className:"text-center text-xl font-semibold flex items-center justify-center gap-2",children:[(0,s.jsx)(B.Z,{className:"h-6 w-6 text-green-500 animate-bounce"}),"Copied Successfully!"]})}),(0,s.jsx)("div",{className:"p-6 text-center",children:(0,s.jsx)("p",{className:"text-lg text-gray-300",children:"The invite link has been copied to your clipboard \uD83C\uDF89"})})]})})}function Y(){let[e,t]=(0,r.useState)([]),[a,n]=(0,r.useState)(!1),[l,o]=(0,r.useState)({top:0,left:0}),[c,i]=(0,r.useState)(0),[d,u]=(0,r.useState)(null),[x,h]=(0,r.useState)(!1),g=async()=>{try{let e=await fetch("http://localhost:8000/leaderboard/users"),a=(await e.json()).sort((e,t)=>t.score-e.score);t(a)}catch(e){console.error("Error fetching leaderboard:",e)}},p=async()=>{try{let e=await fetch("http://localhost:8000/public-stats"),t=await e.json();i(t.active_nodes)}catch(e){console.error("Error fetching public stats:",e)}},f=async()=>{try{let e=localStorage.getItem("authToken");if(!e){console.error("No auth token found");return}let t=await fetch("http://localhost:8000/user",{headers:{Authorization:"Bearer ".concat(e)}}),a=await t.json();u(a.referral_link)}catch(e){console.error("Error fetching user data:",e)}};return(0,r.useEffect)(()=>{g(),p(),f();let e=setInterval(g,3e4),t=setInterval(p,3e4);return()=>{clearInterval(e),clearInterval(t)}},[]),(0,r.useEffect)(()=>{let e=e=>{a&&!e.target.closest(".invite-popup")&&n(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[a]),(0,s.jsxs)(E,{className:"bg-[#1a1a2e] border-0",children:[(0,s.jsx)(T,{children:(0,s.jsxs)(A,{className:"flex items-center justify-center text-white",children:[(0,s.jsx)(U.Z,{className:"w-5 h-5 text-yellow-400 mr-2"}),(0,s.jsx)("span",{children:"LEADERBOARD"}),(0,s.jsx)(U.Z,{className:"w-5 h-5 text-yellow-400 ml-2"})]})}),(0,s.jsxs)(R,{children:[(0,s.jsx)("div",{className:"space-y-4",children:e.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("span",{className:"text-gray-400 w-6",children:[t+1,"."]}),(0,s.jsx)(S.default,{src:"https://ui-avatars.com/api/?name=".concat(encodeURIComponent(e.username),"&background=random&color=fff"),alt:e.username,width:24,height:24,className:"rounded-full"}),(0,s.jsx)("span",{className:"text-gray-400",children:e.username}),(0,s.jsx)("span",{className:"ml-auto text-white",children:e.score})]},t))}),(0,s.jsx)("div",{className:"mt-6 pt-4 border-t border-gray-800",children:(0,s.jsxs)("div",{className:"flex items-center justify-between text-gray-400",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(q.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"No. of active nodes"})]}),(0,s.jsx)("span",{className:"text-white",children:c})]})}),(0,s.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,s.jsxs)(m,{onClick:e=>{let t=e.currentTarget.getBoundingClientRect();o({top:t.bottom+window.scrollY,left:t.left+window.scrollX}),n(!a)},className:"w-full bg-purple-500 hover:bg-purple-600 text-white",children:[(0,s.jsx)(G.Z,{className:"w-4 h-4 mr-2"}),"Invite a friend and earn in Aptos"]}),a&&(0,s.jsx)("div",{className:"absolute z-10 p-2 bg-gray-800 rounded-lg shadow-lg invite-popup",style:{top:"".concat(l.top,"px"),left:"".concat(l.left,"px")},children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-300 truncate mr-2",children:null===d?"Null":d}),(0,s.jsx)(m,{onClick:()=>{navigator.clipboard.writeText(null===d?"Null":d),h(!0),n(!1)},variant:"ghost",size:"sm",className:"text-gray-400 hover:text-gray-700",children:(0,s.jsx)(H.Z,{className:"w-4 h-4"})})]})})]})]}),(0,s.jsx)(V,{open:x,onClose:()=>h(!1)})]})}function J(){let[e,t]=(0,r.useState)(null);if((0,r.useEffect)(()=>{let e=()=>{fetch("".concat("http://127.0.0.1:39281","/v1/hardware")).then(e=>e.json()).then(e=>t(e)).catch(e=>console.error("Failed to fetch system info:",e))};e();let a=setInterval(e,2e3);return()=>clearInterval(a)},[]),!e)return(0,s.jsx)("div",{className:"text-gray-400",children:"Loading system info..."});let{cpu:a,gpus:n,ram:l}=e,o=n.find(e=>e.name.includes("NVIDIA"))||n[0],c=Math.round((l.total-l.available)/l.total*100),i=o?Math.round((o.total_vram-o.free_vram)/o.total_vram*100):0;return(0,s.jsxs)("div",{className:"flex items-center justify-between gap-6 p-4 bg-[#1a1a2e] rounded-lg text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-6",children:[(0,s.jsx)("span",{className:"text-emerald-400 bg-emerald-400/10 px-2 py-1 rounded",children:"AI READY"}),(0,s.jsx)("span",{className:"text-gray-400",children:o?o.name:"No GPU Detected"}),(0,s.jsx)("span",{className:"text-gray-400",children:a.model})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"RAM"}),(0,s.jsx)("div",{className:"w-20 h-2 bg-[#12121f] rounded",children:(0,s.jsx)("div",{className:"h-full bg-blue-500 rounded",style:{width:"".concat(c,"%")}})}),(0,s.jsxs)("span",{className:"text-gray-400",children:[c,"%"]})]}),o&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"GPU VRAM"}),(0,s.jsx)("div",{className:"w-20 h-2 bg-[#12121f] rounded",children:(0,s.jsx)("div",{className:"h-full bg-purple-500 rounded",style:{width:"".concat(i,"%")}})}),(0,s.jsxs)("span",{className:"text-gray-400",children:[i,"%"]})]})]})]})}var $=a(2351);function K(e){return(0,s.jsx)("svg",{role:"img",viewBox:"0 0 24 24",fill:"currentColor",...e,children:(0,s.jsx)("path",{d:"M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"})})}function X(){let[e,t]=(0,r.useState)({dllm_price:{current:0,yesterday:0},btc_price:{current:0,yesterday:0},twitter_followers:0,online_discord_users:0,twitter_link:"",discord_link:""});(0,r.useEffect)(()=>{let e=async()=>{try{let e=await fetch("http://localhost:8000/public-stats"),a=await e.json();t(a)}catch(e){console.error("Failed to fetch stats:",e)}};e();let a=setInterval(e,6e4);return()=>clearInterval(a)},[]);let a=e=>{var t,a;(null===(a=window.electron)||void 0===a?void 0:null===(t=a.shell)||void 0===t?void 0:t.openExternal)?window.electron.shell.openExternal(e):window.open(e,"_blank","noopener,noreferrer")},n=(e,t)=>((e-t)/t*100).toFixed(2);return(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-[#1a1a2e] rounded-lg text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center gap-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Aptos (24h)"}),(0,s.jsxs)("span",{className:"text-white",children:["$",e.dllm_price.current.toFixed(3)]}),(0,s.jsxs)("span",{className:"".concat(0>n(e.dllm_price.current,e.dllm_price.yesterday)?"text-red-500":"text-green-500"),children:[Math.abs(n(e.dllm_price.current,e.dllm_price.yesterday)),"%"," ",0>n(e.dllm_price.current,e.dllm_price.yesterday)?"↓":"↑"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"BTC (24h)"}),(0,s.jsxs)("span",{className:"text-white",children:["$",e.btc_price.current.toLocaleString()]}),(0,s.jsxs)("span",{className:"".concat(0>n(e.btc_price.current,e.btc_price.yesterday)?"text-red-500":"text-green-500"),children:[Math.abs(n(e.btc_price.current,e.btc_price.yesterday)),"%"," ",0>n(e.btc_price.current,e.btc_price.yesterday)?"↓":"↑"]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-6",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Find us on:"}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("a",{href:e.twitter_link,onClick:t=>{t.preventDefault(),a(e.twitter_link)},className:"cursor-pointer flex items-center hover:opacity-80 transition-opacity",children:[(0,s.jsx)($.Z,{className:"w-5 h-5 text-gray-400"}),(0,s.jsxs)("span",{className:"text-gray-400 ml-2",children:[e.twitter_followers," FOLLOWERS"]})]}),(0,s.jsxs)("a",{href:e.discord_link,onClick:t=>{t.preventDefault(),a(e.discord_link)},className:"cursor-pointer flex items-center hover:opacity-80 transition-opacity",children:[(0,s.jsx)(K,{className:"w-5 h-5 text-gray-400"}),(0,s.jsxs)("span",{className:"text-gray-400 ml-2",children:["ONLINE ",e.online_discord_users]})]})]})]})]})}var Q=a(9345),ee=a(6337);let et=r.forwardRef((e,t)=>{let{className:a,type:r,...n}=e;return(0,s.jsx)("input",{type:r,className:d("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...n})});et.displayName="Input";var ea=a(9699);let es=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(ea.fC,{ref:t,className:d("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...r,children:(0,s.jsx)(ea.z$,{className:d("flex items-center justify-center text-current"),children:(0,s.jsx)(B.Z,{className:"h-4 w-4"})})})});function er(e){let{onLogin:t,onForgotPassword:a,onSignup:l}=e,[o,c]=(0,r.useState)(""),[i,d]=(0,r.useState)(""),[u,x]=(0,r.useState)(""),h=e=>{var t,a;(null===(a=window.electron)||void 0===a?void 0:null===(t=a.shell)||void 0===t?void 0:t.openExternal)?window.electron.shell.openExternal(e):window.open(e,"_blank","noopener,noreferrer")},g=async e=>{e.preventDefault(),x("");try{let e=(await n.Z.post("http://localhost:8000/token",new URLSearchParams({username:o,password:i}),{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data.access_token;t(e)}catch(e){x("Invalid email or password"),console.error(e)}};return(0,s.jsx)("div",{className:"min-h-screen bg-[#0a0a14] flex items-center justify-center p-4",children:(0,s.jsx)(E,{className:"w-full max-w-md bg-[#12121f] border-0 shadow-2xl",children:(0,s.jsxs)(R,{className:"pt-12 pb-8 px-8",children:[(0,s.jsx)("div",{className:"flex justify-center mb-8",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(S.default,{src:"https://zgzfpxamyedvgkvh.public.blob.vercel-storage.com/ComputeMesh%20Logo-65v9DaySZ5gBRpTeCeLzqKF0nWaG8a.ico",alt:"DLLM Logo",width:32,height:32}),(0,s.jsx)("span",{className:"text-white text-xl font-semibold",children:"ComputeMesh"}),(0,s.jsx)("span",{className:"bg-[#1f1f2f] text-xs px-2 py-1 rounded",children:"AI"})]})}),(0,s.jsx)("h1",{className:"text-2xl font-semibold text-white text-center mb-8",children:"Login"}),(0,s.jsxs)("form",{onSubmit:g,className:"space-y-6",children:[u&&(0,s.jsx)("div",{className:"text-red-500 text-center mb-4",children:u}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(Q.Z,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),(0,s.jsx)(et,{type:"email",placeholder:"Your email",className:"pl-10 bg-[#1f1f2f] border-0 text-white placeholder:text-gray-400",value:o,onChange:e=>c(e.target.value),required:!0})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(ee.Z,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),(0,s.jsx)(et,{type:"password",placeholder:"Password",className:"pl-10 bg-[#1f1f2f] border-0 text-white placeholder:text-gray-400",value:i,onChange:e=>d(e.target.value),required:!0})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(es,{id:"remember",defaultChecked:!0,className:"border-gray-400 data-[state=checked]:bg-purple-500"}),(0,s.jsx)("label",{htmlFor:"remember",className:"text-sm font-medium text-gray-400 leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Remember me"})]}),(0,s.jsx)("button",{type:"button",onClick:a,className:"text-sm text-blue-400 hover:text-blue-300",children:"Forgot password?"})]}),(0,s.jsx)(m,{type:"submit",className:"w-full bg-purple-500 hover:bg-purple-600 text-white",children:"Login"}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Don't have an account?"}),(0,s.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),h("http://localhost:8000/signup")},className:"ml-2 text-blue-400 hover:text-blue-300",children:"Sign up"})]})]})]})})})}function en(e){let{onResetPassword:t,onBackToLogin:a}=e,[n,l]=(0,r.useState)("");return(0,s.jsx)("div",{className:"min-h-screen bg-[#0a0a14] flex items-center justify-center p-4",children:(0,s.jsx)(E,{className:"w-full max-w-md bg-[#12121f] border-0 shadow-2xl",children:(0,s.jsxs)(R,{className:"pt-12 pb-8 px-8",children:[(0,s.jsx)("div",{className:"flex justify-center mb-8",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-white text-xl font-semibold",children:"ComputeMesh"}),(0,s.jsx)("span",{className:"bg-[#1f1f2f] text-xs px-2 py-1 rounded",children:"AI"})]})}),(0,s.jsx)("h1",{className:"text-2xl font-semibold text-white text-center mb-8",children:"Reset Password"}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t(n)},className:"space-y-6",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(Q.Z,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),(0,s.jsx)(et,{type:"email",placeholder:"Your email",className:"pl-10 bg-[#1f1f2f] border-0 text-white placeholder:text-gray-400",value:n,onChange:e=>l(e.target.value),required:!0})]}),(0,s.jsx)(m,{type:"submit",className:"w-full bg-purple-500 hover:bg-purple-600 text-white",children:"Reset Password"}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("button",{type:"button",onClick:a,className:"text-sm text-blue-400 hover:text-blue-300",children:"Back to Login"})})]})]})})})}es.displayName=ea.fC.displayName;var el=a(2934),eo=e=>{let{isAuthenticated:t=!1}=e,[a,n]=r.useState(!0),[l,o]=r.useState(null),[c]=r.useState(()=>"true"===localStorage.getItem("updateDeferred")),i=t&&!c,d=async()=>{try{o(null),console.log("Attempting to install update..."),await window.electronAPI.installUpdate()}catch(e){console.error("Failed to install update:",e),o("Failed to install update. Please try again.")}},u=async()=>{try{o(null),localStorage.setItem("updateDeferred","true"),n(!1)}catch(e){console.error("Failed to close dialog:",e),o("Failed to close dialog. Please try again.")}},x=async()=>{try{o(null),console.log("Attempting to close app..."),await window.electronAPI.closeApp()}catch(e){console.error("Failed to close app:",e),o("Failed to close application. Please try again.")}};return(0,s.jsx)(g,{open:a,onOpenChange:()=>{},children:(0,s.jsxs)(v,{className:"max-w-md bg-gray-900 border border-gray-800 text-white shadow-2xl",children:[(0,s.jsx)(b,{children:(0,s.jsx)(w,{className:"text-xl font-semibold text-center text-white",children:"Application Update"})}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsx)("div",{className:"flex items-center justify-center",children:(0,s.jsx)(el.Z,{className:"h-16 w-16 text-green-500"})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-center text-white",children:"Update Ready to Install"}),(0,s.jsxs)("p",{className:"text-sm text-gray-400 text-center",children:["A new version of the application is ready to install. The application will restart automatically to complete the installation.",!i&&(0,s.jsx)("span",{className:"block mt-2 text-yellow-400",children:"This update must be installed to continue using the application."})]}),(0,s.jsxs)("div",{className:"flex justify-center gap-4 pt-2",children:[(0,s.jsxs)(m,{onClick:d,className:"bg-green-600 hover:bg-green-700 transition-colors text-white",children:[(0,s.jsx)(el.Z,{className:"mr-2 h-4 w-4"}),"Install Now"]}),i?(0,s.jsx)(m,{onClick:u,variant:"outline",className:"border-gray-700 text-gray-400 hover:bg-gray-800 hover:text-white transition-colors",children:"Later"}):(0,s.jsx)(m,{onClick:x,variant:"outline",className:"border-gray-700 text-gray-400 hover:bg-gray-800 hover:text-white transition-colors",children:"Close App"})]})]})]}),l&&(0,s.jsx)("div",{className:"mt-4 p-3 bg-red-900/50 border border-red-700 rounded-lg",children:(0,s.jsx)("p",{className:"text-sm text-red-400 text-center",children:l})})]})]})})};function ec(){let[e,t]=(0,r.useState)("login"),[a,l]=(0,r.useState)(null),[o,c]=(0,r.useState)(null),[i,d]=(0,r.useState)(""),[u,m]=(0,r.useState)(!1),[x,h]=(0,r.useState)(!1),[g,p]=(0,r.useState)(""),[f,v]=(0,r.useState)("");(0,r.useEffect)(()=>{window.electronAPI&&window.electronAPI.onUpdateDownloaded(()=>{m(!0)})},[]),(0,r.useEffect)(()=>{let e=localStorage.getItem("authToken"),t=localStorage.getItem("explicitLogout");e&&"true"!==t&&b(e)},[]),(0,r.useEffect)(()=>{(async()=>{try{let e=await window.electronAPI.getMachineId();await n.Z.post("http://localhost:8000/device-registration",{device_id:e},{headers:{"Content-Type":"application/json"}}),console.log("Device registered successfully")}catch(e){console.error("Device registration failed:",e)}})()},[]);let b=async e=>{try{let a=await n.Z.get("http://localhost:8000/user",{headers:{Authorization:"Bearer ".concat(e)}});c(a.data),l(e),t("authenticated")}catch(e){localStorage.removeItem("authToken"),sessionStorage.removeItem("miningTime"),sessionStorage.removeItem("miningPending"),t("login")}},w=async e=>{localStorage.setItem("authToken",e),localStorage.removeItem("explicitLogout");try{let a=await n.Z.get("http://localhost:8000/user",{headers:{Authorization:"Bearer ".concat(e)}});c(a.data),l(e),t("authenticated")}catch(e){localStorage.removeItem("authToken"),t("login")}},j=e=>/^0x[0-9a-fA-F]{64}$/.test(e),y=async()=>{if(!j(g)){v("Please enter a valid Aptos address (0x followed by 64 hex characters)");return}try{await n.Z.patch("http://localhost:8000/user/wallet",{wallet_address:g},{headers:{Authorization:"Bearer ".concat(a)}}),c({...o,wallet_address:g}),h(!1),p(""),v("")}catch(e){console.error("Error saving wallet address:",e),v("Failed to connect wallet. Please try again.")}};return"login"===e?(0,s.jsxs)(s.Fragment,{children:[u&&(0,s.jsx)(eo,{isAuthenticated:"authenticated"===e}),(0,s.jsx)(er,{onLogin:w,onForgotPassword:()=>{t("forgotPassword")},onSignup:()=>{console.log("Navigate to signup page")}}),i&&(0,s.jsx)("div",{className:"fixed bottom-4 right-4 bg-green-500 text-white p-4 rounded-md shadow-lg",children:i})]}):"forgotPassword"===e?(0,s.jsx)(en,{onResetPassword:e=>{console.log("Password reset requested for:",e),d("Password reset link has been sent to your email."),t("login")},onBackToLogin:()=>{t("login")}}):(0,s.jsxs)("div",{className:"min-h-screen bg-[#0a0a14] flex",children:[u&&(0,s.jsx)(eo,{isAuthenticated:"authenticated"===e}),x&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-[#1a1a2e] p-6 rounded-lg w-full max-w-md",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Connect Aptos Wallet"}),(0,s.jsx)("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-white",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-gray-400 mb-2",children:"Enter your Aptos wallet address"}),(0,s.jsx)("input",{type:"text",value:g,onChange:e=>p(e.target.value),placeholder:"0x...",className:"w-full bg-[#12121f] border border-gray-700 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-2 focus:ring-purple-500"}),f&&(0,s.jsx)("p",{className:"mt-2 text-red-400 text-sm",children:f})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:()=>h(!1),className:"px-4 py-2 bg-gray-700 text-white rounded-md hover:bg-gray-600 transition",children:"Cancel"}),(0,s.jsx)("button",{onClick:y,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition",children:"Connect"})]})]})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(N,{userData:o,onConnectWallet:()=>h(!0)}),(0,s.jsx)("div",{className:"mb-4"}),(0,s.jsx)(C,{onLogout:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("updateDeferred"),localStorage.setItem("explicitLogout","true"),sessionStorage.removeItem("miningTime"),sessionStorage.removeItem("miningPending"),l(null),c(null),t("login")},userData:o}),(0,s.jsxs)("main",{className:"p-6 pt-0 pb-0",children:[(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-6 mb-6",children:[(0,s.jsx)(F,{}),(0,s.jsx)(O,{}),(0,s.jsx)(Y,{})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(J,{}),(0,s.jsx)(X,{})]})]})]})]})}}},function(e){e.O(0,[576,971,117,744],function(){return e(e.s=3934)}),_N_E=e.O()}]);